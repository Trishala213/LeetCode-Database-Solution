--challenge 175: Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people

select FirstName, LastName, City, State
from Person p left join Address a on p.PersonId = a.PersonId

--challenge 176: Write a SQL query to get the second highest salary from the Employee table.

select max(salary) as SecondHighestSalary
from Employee
where salary not in (select max(salary) from Employee) 

--challenge 177:

CREATE FUNCTION getNthHighestSalary(@N INT) RETURNS INT AS
BEGIN
    RETURN (
        /* Write your T-SQL query statement below. */
        
          select distinct Salary
          from 
           (select dense_rank() over (order by salary desc) as Ranks, ID, Salary
            from Employee) as a
            --order by Ranks Desc) as a
          where a.Ranks = @N
    );
END
